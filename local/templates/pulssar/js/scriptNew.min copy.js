window.addEventListener("load",(function(){document.getElementById("preloader").style.display="none"}));const thumbsSwiper=new Swiper(".swiper-thumbs",{spaceBetween:11,slidesPerView:7,watchSlidesProgress:!0,freeMode:!1,breakpoints:{0:{slidesPerView:4},640:{slidesPerView:5},1031:{slidesPerView:7}}}),mainSwiper=new Swiper(".swiper-main",{spaceBetween:10,navigation:{nextEl:".swiper-button-next-item",prevEl:".swiper-button-prev-item"},thumbs:{swiper:thumbsSwiper}});function createLimitedPagination(e,t={}){const n="number"==typeof t.maxVisible?t.maxVisible:7,r=t.rootSelector||".swiper-pagination",o=document.querySelector(r);if(!o)return void console.warn("Пагинация: root не найдена:",r);o.innerHTML="";const s=document.createElement("div");s.className="custom-pagination-viewport",Object.assign(s.style,{display:"block",overflow:"hidden",whiteSpace:"nowrap",width:"100%",boxSizing:"border-box",position:"relative"});const i=document.createElement("div");function a(t){const n=document.createElement("button");return n.type="button",n.className="custom-pagination-bullet",n.dataset.index=t,Object.assign(n.style,{display:"inline-block",width:"10px",height:"10px",borderRadius:"50%",margin:"0 6px",padding:"0",border:"none",background:"rgba(0,0,0,0.2)",cursor:"pointer",verticalAlign:"middle"}),n.addEventListener("click",(t=>{t.preventDefault();const r=Number(n.dataset.index);if(Number.isFinite(r)){try{"function"==typeof markUserInteraction&&markUserInteraction()}catch(t){}e.slideTo(r)}})),n}function c(){i.innerHTML="";const t=e.slides?e.slides.length:0;for(let e=0;e<t;e++)i.appendChild(a(e));requestAnimationFrame((()=>{u(),d(e.activeIndex||0)}))}function l(){const e=i.querySelector(".custom-pagination-bullet");if(!e)return{dotWidth:22,visibleCount:n};const t=getComputedStyle(e),r=parseFloat(t.marginLeft)||0,a=parseFloat(t.marginRight)||0,c=e.getBoundingClientRect().width+r+a,l=s.getBoundingClientRect().width||o.getBoundingClientRect().width||window.innerWidth,d=Math.floor(l/c)||1;return{dotWidth:c,visibleCount:Math.min(n,d)}}function d(e){const t=Array.from(i.querySelectorAll(".custom-pagination-bullet"));if(t.forEach(((t,n)=>{n===e?(t.style.background="#cfa567",t.setAttribute("aria-current","true")):(t.style.background="rgba(0,0,0,0.2)",t.removeAttribute("aria-current"))})),!t.length)return;const{dotWidth:n,visibleCount:r}=l(),o=t.length,s=Math.floor(r/2);let a=Math.max(0,e-s);a=Math.min(a,Math.max(0,o-r));const c=a*n;i.style.transform=`translate3d(${-c}px,0,0)`}function u(){const t=Array.from(i.querySelectorAll(".custom-pagination-bullet")),{dotWidth:n,visibleCount:r}=l();i.style.width=t.length*n+"px",d(e.activeIndex||0)}i.className="custom-pagination-track",Object.assign(i.style,{display:"inline-block",transition:"transform 280ms ease",willChange:"transform",padding:"6px 0"}),s.appendChild(i),o.appendChild(s),e.on("init slideChange transitionEnd resize update",(()=>{i.querySelector(".custom-pagination-bullet")?(u(),d(e.activeIndex||0)):c()})),c();let m=null;return window.addEventListener("resize",(()=>{clearTimeout(m),m=setTimeout((()=>{u()}),120)})),{root:o,viewport:s,track:i,updateActive:d,renderDots:c}}function updateNavButtons(e){const t=document.querySelector(".swiper-button-prev-item"),n=document.querySelector(".swiper-button-next-item");t&&n&&(e.isBeginning?(t.classList.add("disabled"),t.disabled=!0,t.setAttribute("aria-disabled","true")):(t.classList.remove("disabled"),t.disabled=!1,t.setAttribute("aria-disabled","false")),e.isEnd?(n.classList.add("disabled"),n.disabled=!0,n.setAttribute("aria-disabled","true")):(n.classList.remove("disabled"),n.disabled=!1,n.setAttribute("aria-disabled","false")))}createLimitedPagination(mainSwiper,{maxVisible:7}),mainSwiper.on("init",(()=>updateNavButtons(mainSwiper))),mainSwiper.on("slideChange transitionEnd update resize",(()=>updateNavButtons(mainSwiper))),updateNavButtons(mainSwiper),window.productThumbsSwiper=thumbsSwiper,window.productMainSwiper=mainSwiper;let lastUserInteractionAt=0;const USER_INTERACTION_WINDOW=900;function markUserInteraction(){lastUserInteractionAt=performance&&performance.now?performance.now():Date.now()}function wasRecentlyUserInitiated(){return(performance&&performance.now?performance.now():Date.now())-lastUserInteractionAt<=900}const html=document.documentElement,body=document.body,modalGallery=document.getElementById("galleryModal");function deleteFavorite(e){console.log("Удалён из избранного:",e)}document.addEventListener("DOMContentLoaded",(async function(){if(!document.querySelector(".swiper-thumbs"))return;const e=Array.from(document.querySelectorAll(".swiper-main .swiper-slide")),t=document.querySelector(".swiper-thumbs .swiper-wrapper");t.innerHTML="";const n=[];e.forEach(((e,r)=>{const o=document.createElement("div");o.className="swiper-slide";const s=e.querySelector("video"),i=e.querySelector("img");if(s){const e=s.currentSrc||s.src;if(o.innerHTML='\n          <div class="thumb-media" aria-hidden="false">\n            <span class="thumb-play-icon" aria-hidden="true">\n              <svg viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg" role="img" aria-hidden="true" focusable="false">\n                <circle cx="32" cy="32" r="28" fill="rgba(0,0,0,0.56)"/>\n                <polygon points="24,20 24,44 48,32" fill="#ffffff"/>\n              </svg>\n            </span>\n          </div>\n        ',o.dataset.type="video",e){const t=function(e,t=.05,n=5e3){return new Promise(((r,o)=>{if(!e)return o(new Error("no video src"));const s=document.createElement("video");s.crossOrigin="anonymous",s.preload="metadata",s.muted=!0,s.playsInline=!0,s.src=e;let i=!1;const a=()=>{try{s.src=""}catch(e){}s.remove()},c=()=>{if(!i)try{const e=s.videoWidth,t=s.videoHeight;if(!e||!t)throw new Error("no video dimensions");const n=document.createElement("canvas");n.width=e,n.height=t,n.getContext("2d").drawImage(s,0,0,e,t);const o=n.toDataURL("image/jpeg",.8);i=!0,a(),r(o)}catch(e){i=!0,a(),o(e)}};setTimeout((()=>{i||(i=!0,a(),o(new Error("timeout capturing frame")))}),n),s.addEventListener("loadeddata",(()=>{try{const e=Math.min(t,s.duration&&s.duration/2||t);s.currentTime=e}catch(e){c()}}),{once:!0}),s.addEventListener("seeked",(()=>{c()}),{once:!0}),s.addEventListener("error",(()=>{i||(i=!0,a(),o(new Error("video load error")))}),{once:!0}),s.style.display="none",document.body.appendChild(s)}))}(e,.05,5e3).then((e=>{const t=o.querySelector(".thumb-media"),n=document.createElement("img");n.src=e,n.alt="video thumb",t.prepend(n)})).catch((t=>{console.warn("Thumbnail generation failed for",e,t)}));n.push(t)}}else o.innerHTML=i?`<div class="thumb-media"><img src="${i.src}" alt=""></div>`:'<div class="thumb-media"><img src="img/product/placeholder.jpg" alt=""></div>';t.appendChild(o)}));try{await Promise.race([Promise.all(n),new Promise((e=>setTimeout(e,3e3)))])}catch(e){console.warn("Some thumbnails generation failed or timed out",e)}function r(){document.querySelectorAll(".swiper-main video").forEach((e=>{try{e.pause()}catch(e){}}))}window.gotoMainImageByUrl=async function(e,t={}){const{speed:n=600,addIfMissing:r=!0}=t;if(!window.productMainSwiper||!window.productThumbsSwiper)return console.warn("productMainSwiper or productThumbsSwiper not found yet"),!1;let o=Array.isArray(e)?e[0]||"":e||"";if(!o)return!1;function s(e){try{return e.split("?")[0].trim().toLowerCase()}catch(t){return String(e).toLowerCase()}}const i=s(o),a=function(e){const t=s(e).split("/");return t[t.length-1]||""}(o),l=window.productMainSwiper,m=window.productThumbsSwiper,p=Array.from(document.querySelectorAll(".swiper-main .swiper-slide"));let y=-1;for(let e=0;e<p.length;e++){const t=p[e],n=t.querySelector("img"),r=t.querySelector("video");if(n&&n.src){const e=s(n.src);if(e===i||e.includes(i)||i.includes(e)||e.endsWith(a)||a&&e.includes(a)){const e=Array.from(l.slides).indexOf(t);if(e>=0){y=e;break}}}if(r){const e=r.getAttribute("poster")||"",n=r.currentSrc||r.src||"",o=s(e),c=s(n);if(o&&(o===i||o.includes(a))||c&&(c===i||c.includes(a))){const e=Array.from(l.slides).indexOf(t);if(e>=0){y=e;break}}}}if(y>=0){try{"function"==typeof markUserInteraction&&markUserInteraction()}catch(e){}l.slideTo(y,n);try{m.slideTo(y,Math.max(n/2,300))}catch(e){}return!0}if(!r)return!1;try{const e=document.querySelector(".swiper-wrapper.main-images-swiper"),t=document.querySelector(".swiper-thumbs .swiper-wrapper"),r=document.querySelector("#galleryModal .swiper-fullscreen .swiper-wrapper");e&&t||console.warn("Основной или thumbs wrapper не найден, добавляем в конец");let s=0;const i=e?Array.from(e.children):[];i[0]&&i[0].querySelector("video")&&(s=1);let a=-1;for(let e=s;e<i.length;e++){if(!i[e].querySelector("video")){a=e;break}}if(-1===a&&i.length>0&&(i[0].querySelector("video")||(a=0)),a>=0){const e=i[a];e.innerHTML=`<img src="${o}" alt="">`;const s=Array.from(t.children);if(s[a]&&(s[a].innerHTML=`<div class="thumb-media"><img src="${o}" alt=""></div>`,delete s[a].dataset.type),r&&r.children[a]){const e=r.children[a];e.innerHTML="";const t=document.createElement("img");t.src=o,t.removeAttribute("width"),t.removeAttribute("height"),e.appendChild(t)}try{m.update()}catch(e){}try{l.update()}catch(e){}try{void 0!==d&&d&&d.update()}catch(e){}try{!function(e,t){try{const n=e.querySelector("img")||e;n&&(n.style.cursor="pointer",n.addEventListener("click",(e=>{e.preventDefault(),markUserInteraction(),c(),u(t)})))}catch(e){}}(e,a)}catch(e){}try{"function"==typeof markUserInteraction&&markUserInteraction()}catch(e){}l.slideTo(a,n);try{m.slideTo(a,Math.max(n/2,300))}catch(e){}return!0}{const s=document.createElement("div");s.className="swiper-slide",s.innerHTML=`<img src="${o}" alt="">`,e&&e.appendChild(s);const i=document.createElement("div");if(i.className="swiper-slide",i.innerHTML=`<div class="thumb-media"><img src="${o}" alt=""></div>`,t&&t.appendChild(i),r){const e=document.createElement("div");e.className="swiper-slide";const t=document.createElement("img");t.src=o,e.appendChild(t),r.appendChild(e)}try{m.update()}catch(e){}try{l.update()}catch(e){}try{void 0!==d&&d&&d.update()}catch(e){}const a=l.slides.length-1;try{const e=s.querySelector("img")||s;e&&(e.style.cursor="pointer",e.addEventListener("click",(e=>{e.preventDefault(),markUserInteraction(),c(),u(a)})))}catch(e){}try{"function"==typeof markUserInteraction&&markUserInteraction()}catch(e){}l.slideTo(a,n);try{m.slideTo(a,Math.max(n/2,300))}catch(e){}return!0}}catch(e){return console.error("Не удалось добавить/переключиться на новый слайд",e),!1}},mainSwiper.on("touchStart",(function(){markUserInteraction()}));if(Array.from(t.querySelectorAll(".swiper-slide")).forEach(((t,n)=>{t.addEventListener("click",(t=>{t.preventDefault(),markUserInteraction(),mainSwiper.slideTo(n);const r=e[n],o=r?r.querySelector("video"):null;if(o)try{o.muted=!1,o.play().catch((()=>{}))}catch(t){}}))})),e.forEach((e=>{const t=e.querySelector("video");if(!t)return;"static"===getComputedStyle(e).position&&(e.style.position="relative");let n=!1,o=0,s=0;const i=e=>{n=!1;try{e.target.releasePointerCapture(e.pointerId)}catch(e){}};t.addEventListener("pointerdown",(e=>{if("mouse"!==e.pointerType||0===e.button){n=!0,o=e.clientX,s=e.clientY,markUserInteraction();try{e.target.setPointerCapture(e.pointerId)}catch(e){}}}),{passive:!0}),t.addEventListener("pointermove",(e=>{if(!n)return;const t=e.clientX-o,i=e.clientY-s;if(Math.abs(t)>30&&Math.abs(t)>Math.abs(i)){n=!1;try{e.target.releasePointerCapture(e.pointerId)}catch(e){}r(),t<0?mainSwiper.slideNext():mainSwiper.slidePrev()}}),{passive:!0}),t.addEventListener("pointerup",i,{passive:!0}),t.addEventListener("pointercancel",i,{passive:!0}),t.addEventListener("click",(()=>{markUserInteraction()}))})),mainSwiper.on("slideChangeTransitionEnd",(()=>{document.querySelectorAll(".main-unmute-btn").forEach((e=>e.style.display="none")),r();const e=mainSwiper.slides[mainSwiper.activeIndex];if(!e)return;const t=e.querySelector("video");t&&(wasRecentlyUserInitiated()?(t.muted=!1,t.play().then((()=>{})).catch((()=>{t.muted=!0,t.play().catch((()=>{}));const n=function(e,t){let n=e.querySelector(".main-unmute-btn");return n||(n=document.createElement("button"),n.className="main-unmute-btn",n.type="button",n.textContent="Включить звук",e.style.position="relative",e.appendChild(n),n.addEventListener("click",(e=>{e.stopPropagation();try{t.muted=!1,t.play().catch((()=>{})),n.style.display="none"}catch(e){}}))),n}(e,t);n.style.display="inline-block"}))):(t.muted=!0,t.play().catch((()=>{}))))})),setTimeout((()=>mainSwiper.emit("slideChangeTransitionEnd")),60),!modalGallery)return;const o=document.querySelector(".swiper-wrapper.main-images-swiper"),s=modalGallery.querySelector(".swiper-fullscreen .swiper-wrapper"),i=modalGallery.querySelector(".modal-close"),a=modalGallery.querySelector(".fullscreen-overlay");function c(){document.querySelectorAll("video").forEach((e=>{try{e.pause()}catch(e){}}))}function l(e,t){let n=e.querySelector(".main-unmute-btn");return n||(n=document.createElement("button"),n.className="main-unmute-btn",n.type="button",n.textContent="Включить звук",e.appendChild(n),n.addEventListener("click",(e=>{e.stopPropagation();try{t.muted=!1,t.play().catch((()=>{})),n.style.display="none"}catch(e){}}))),n}s.innerHTML="";Array.from(o?o.querySelectorAll(".swiper-slide"):[]).forEach((e=>{const t=document.createElement("div");t.className="swiper-slide";const n=e.querySelector("video"),r=e.querySelector("img");if(n){const e=document.createElement("video");e.className="modal-video",e.src=n.currentSrc||n.src,e.preload="metadata",e.playsInline=!0,e.controls=!0,e.setAttribute("playsinline",""),t.appendChild(e)}else if(r){const e=r.cloneNode(!0);e.removeAttribute("width"),e.removeAttribute("height"),t.appendChild(e)}else{const e=document.createElement("div");e.style.width="100%",e.style.height="100%",t.appendChild(e)}s.appendChild(t)}));let d=null;function u(e){c(),modalGallery.classList.add("open"),html.classList.add("no-scroll"),body.classList.add("no-scroll"),d||function(){if(d)return;[modalGallery.querySelector(".swiper-button-next"),modalGallery.querySelector(".swiper-button-prev")].forEach((e=>{e&&e.replaceWith(e.cloneNode(!0))}));const e=modalGallery.querySelector(".swiper-button-next"),t=modalGallery.querySelector(".swiper-button-prev");[e,t].forEach((e=>{e&&e.addEventListener("click",(t=>{t.stopPropagation(),t.preventDefault(),markUserInteraction(),e.disabled=!0,setTimeout((()=>{e.disabled=!1}),300)}),{passive:!1})})),d=new Swiper(modalGallery.querySelector(".swiper-fullscreen"),{slidesPerView:1,centeredSlides:!1,navigation:{nextEl:e,prevEl:t},loop:!1,speed:400}),d.on("touchStart",(()=>{markUserInteraction()})),[e,t].forEach((e=>{e&&e.addEventListener("click",(()=>{markUserInteraction()}),{passive:!0})})),s.querySelectorAll("video.modal-video").forEach((e=>{let t=!1,n=0,r=0;const o=e=>{t=!1;try{e.target.releasePointerCapture(e.pointerId)}catch(e){}};e.addEventListener("pointerdown",(e=>{if("mouse"!==e.pointerType||0===e.button){t=!0,n=e.clientX,r=e.clientY,markUserInteraction();try{e.target.setPointerCapture(e.pointerId)}catch(e){}}}),{passive:!0}),e.addEventListener("pointermove",(e=>{if(!t)return;const o=e.clientX-n,s=e.clientY-r;if(Math.abs(o)>30&&Math.abs(o)>Math.abs(s)){t=!1;try{e.target.releasePointerCapture(e.pointerId)}catch(e){}o<0?d.slideNext():d.slidePrev()}}),{passive:!0}),e.addEventListener("pointerup",o,{passive:!0}),e.addEventListener("pointercancel",o,{passive:!0}),e.addEventListener("click",(()=>{markUserInteraction()}))})),d.on("slideChangeTransitionEnd",(()=>{s.querySelectorAll(".main-unmute-btn").forEach((e=>e.style.display="none")),s.querySelectorAll("video.modal-video").forEach((e=>{try{e.pause()}catch(e){}}));const e=d.activeIndex,t=s.children[e];if(!t)return;const n=t.querySelector("video.modal-video");n&&(wasRecentlyUserInitiated()?(n.muted=!1,n.play().then((()=>{})).catch((()=>{n.muted=!0,n.play().catch((()=>{})),l(t,n).style.display="inline-block"}))):(n.muted=!0,n.play().catch((()=>{}))))}))}(),markUserInteraction(),d.slideTo(e,0);try{const t=s.children[e];if(!t)return;const n=t.querySelector("video.modal-video");if(!n)return;n.muted=!1;const r=n.play();r&&r.catch&&r.catch((()=>{n.muted=!0,n.play().catch((()=>{}));l(t,n).style.display="inline-block"}))}catch(e){}}function m(){modalGallery.classList.remove("open"),modalGallery.classList.add("closing"),html.classList.remove("no-scroll"),body.classList.remove("no-scroll"),s.querySelectorAll("video.modal-video").forEach((e=>{try{e.pause()}catch(e){}})),c(),modalGallery.addEventListener("transitionend",(function e(t){"opacity"===t.propertyName&&(modalGallery.classList.remove("closing"),modalGallery.removeEventListener("transitionend",e))}))}e.forEach(((e,t)=>{const n=e.querySelector("img")||e;n&&(n.style.cursor="pointer",n.addEventListener("click",(e=>{e.preventDefault(),markUserInteraction(),u(t)})))})),i&&i.addEventListener("click",m),a&&a.addEventListener("click",m);modalGallery&&modalGallery.addEventListener('click',e=>{if(!e.target.classList.contains('swiper-button-prev')&&!e.target.classList.contains('swiper-button-next')&&e.target.tagName!=='IMG'&&e.target.tagName!=='VIDEO'){m()}});const p=Array.from(document.querySelectorAll(".product-desc-card-review-images img"));if(p.length>0){const e=s.children.length;p.forEach(((t,n)=>{const r=document.createElement("div");r.className="swiper-slide";const o=t.cloneNode(!0);o.removeAttribute("width"),o.removeAttribute("height"),o.style.maxWidth="100%",o.style.height="auto",o.style.display="block",o.style.margin="0 auto",r.appendChild(o),s.appendChild(r);const i=e+n;t.dataset.modalIndex=i,t.style.cursor="pointer",t.addEventListener("click",(e=>{e.preventDefault(),markUserInteraction(),c(),u(i)}))}))}})),document.addEventListener("click",(function(e){const t=e.target.closest(".add-to-favorites-btn, .add-to-favorite-related-products-btn, .favorite-btn");if(!t)return;e.preventDefault(),e.stopPropagation();const n=t.closest("[data-product-id]");if(!n)return void console.warn("Кнопка без data-product-id:",t);const r=n.dataset.productId,o=t.classList.toggle("active");if(t.setAttribute("aria-pressed",String(o)),o){addToFavorite(r);const e=t.querySelector("svg");e&&e.classList.add("filled")}else{deleteFavorite(r);const e=t.querySelector("svg");e&&e.classList.remove("filled")}}));const favoriteBtn=document.querySelector(".favorite-btn");function resetProductSelection(){try{currentCount=1}catch(e){}document.querySelectorAll(".js-qty-value").forEach((e=>{if("value"in e)try{e.value="1"}catch(e){}try{e.textContent="1"}catch(e){}})),document.querySelectorAll(".js-qty-selector, .item-quantity-selector").forEach((e=>{e.classList.remove("show"),e.style.display="none",e.setAttribute("aria-hidden","true")})),document.querySelectorAll(".js-add-btn, .add-to-cart-btn").forEach((e=>{e.style.display="inline-block";try{e.disabled=!1}catch(e){}try{e.setAttribute("aria-disabled","false")}catch(e){}})),document.querySelectorAll(".in-cart, .added-state").forEach((e=>{e.classList.remove("in-cart","added-state")}))}function selectConfiguration(){const e=document.querySelectorAll(".select-configuration-card");e&&e.forEach((t=>{t.addEventListener("click",(()=>{t.classList.contains("active")||(e.forEach((e=>e.classList.remove("active"))),t.classList.add("active"),console.log("Выбрана комплектация:",t.dataset.id),resetProductSelection())}))}))}favoriteBtn&&favoriteBtn.addEventListener("click",(function(){this.querySelector(".favorite-btn-icon").classList.toggle("filled")})),selectConfiguration(),document.addEventListener("DOMContentLoaded",(()=>{const e=".header-test",t=100;function n(){const n=function(){const e=getComputedStyle(document.documentElement).getPropertyValue("--header-height");if(!e)return null;const t=parseFloat(e.trim());return isNaN(t)?null:t}();if(null!==n)return n;const r=document.querySelector(e);return r?r.offsetHeight:t}function r(){document.documentElement.style.setProperty("--header-height",n()+"px")}function o(e){const t=n(),r=e.getBoundingClientRect().top+window.pageYOffset-t-12;if(window.innerWidth<768)return void window.scrollTo(0,r);const o=window.pageYOffset,s=r-o;let i=null;requestAnimationFrame((function e(t){i||(i=t);const n=t-i,r=Math.min(n/520,1),a=(c=r)<.5?2*c*c:(4-2*c)*c-1;var c;window.scrollTo(0,Math.round(o+s*a)),n<520&&requestAnimationFrame(e)}))}function s(e){return e.querySelector(".product-desc-card-info")}const i=Array.from(document.querySelectorAll(".product-desc-card"));i.forEach((e=>{const t=s(e);t&&(e.classList.contains("open")?t.style.maxHeight=t.scrollHeight+"px":t.style.maxHeight="0px")})),i.forEach((e=>{const t=e.querySelector(".product-desc-card-open-btn"),n=e.querySelector(".click-area"),r=s(e);function a(){if(e.classList.add("open"),t&&(t.classList.add("is-open"),t.setAttribute("aria-expanded","true")),r){r.style.maxHeight="0px",requestAnimationFrame((()=>{r.style.maxHeight=r.scrollHeight+"px"}));const t=setTimeout((()=>{o(e)}),700);r.addEventListener("transitionend",(function n(s){"max-height"===s.propertyName&&(clearTimeout(t),o(e),r.removeEventListener("transitionend",n))}))}else o(e)}function c(){const t=e.classList.contains("open");i.forEach((e=>{if(!e.classList.contains("open"))return;const t=s(e),n=e.querySelector(".product-desc-card-open-btn");if(t){t.style.maxHeight=t.scrollHeight+"px",requestAnimationFrame((()=>{t.style.maxHeight="0px"}));const r=o=>{"max-height"===o.propertyName&&(e.classList.remove("open"),t.style.maxHeight="0px",n&&(n.classList.remove("is-open"),n.setAttribute("aria-expanded","false")),t.removeEventListener("transitionend",r))};t.addEventListener("transitionend",r),setTimeout((()=>{e.classList.contains("open")&&(e.classList.remove("open"),n&&(n.classList.remove("is-open"),n.setAttribute("aria-expanded","false")),t.style.maxHeight="0px")}),600)}else e.classList.remove("open"),n&&(n.classList.remove("is-open"),n.setAttribute("aria-expanded","false"))})),t||setTimeout(a,50)}t&&t.addEventListener("click",c),n&&n.addEventListener("click",c)})),r(),window.addEventListener("resize",(()=>{r(),i.forEach((e=>{const t=s(e);e.classList.contains("open")&&t&&(t.style.maxHeight=t.scrollHeight+"px")}))}));const a=document.querySelector(".product-desc-card-reviews");if(a){const e=a.querySelector(".no-reviews-text"),t=a.querySelectorAll(".product-desc-card-review");e&&(e.style.display=t.length>0?"none":"block")}document.querySelectorAll(".product-desc-card-review-texts").forEach((e=>{const t=e.querySelector(".product-desc-card-review-text"),n=e.querySelector(".product-desc-card-review-more-btn");if(!t||!n)return;const r=3*(parseFloat(getComputedStyle(t).lineHeight)||18);t.scrollHeight<=r?n.style.display="none":n.style.display=""}))}));const productDescCardReviewTexts=document.querySelectorAll(".product-desc-card-review-texts");function initInteractiveCards(){document.querySelectorAll(".image-hover-card").forEach((e=>{const t=Array.from(e.querySelectorAll(".image-container img")),n=Array.from(e.querySelectorAll(".progress-bar .segment")),r=t.length;0!==r&&(t.forEach(((e,t)=>{e.style.opacity=0===t?"1":"0",e.style.transition=e.style.transition||"opacity 240ms ease"})),n.forEach(((e,t)=>e.classList.toggle("active",0===t))),e.addEventListener("mousemove",(o=>{const s=e.getBoundingClientRect(),i=(o.clientX-s.left)/s.width;let a=Math.floor(i*r);a=Math.max(0,Math.min(r-1,a)),t.forEach(((e,t)=>{e.style.opacity=t===a?"1":"0"})),n.forEach(((e,t)=>{e.classList.toggle("active",t===a)}))})),e.addEventListener("mouseleave",(()=>{t.forEach(((e,t)=>{e.style.opacity=0===t?"1":"0"})),n.forEach(((e,t)=>{e.classList.toggle("active",0===t)}))})))}))}function initRelatedProductsSwiper(){document.querySelectorAll(".js-related-products").forEach((e=>{const t=e.querySelector(".related-products-swiper");if(!t)return;const n=e.querySelector(".related-products-right-arrow"),r=e.querySelector(".related-products-left-arrow");function o(e){n&&n.classList.toggle("arrow-disabled",e.isEnd),r&&r.classList.toggle("arrow-disabled",e.isBeginning)}new Swiper(t,{slidesPerView:3,spaceBetween:40,slidesPerGroup:1,loop:!1,navigation:{nextEl:n||void 0,prevEl:r||void 0},breakpoints:{0:{slidesPerView:1.05,spaceBetween:10},670:{slidesPerView:1.5,spaceBetween:10},769:{slidesPerView:1.5,spaceBetween:10},950:{slidesPerView:2.1,spaceBetween:20},1130:{slidesPerView:2.5,spaceBetween:20},1380:{slidesPerView:3,spaceBetween:40},1751:{slidesPerView:3,spaceBetween:40}},on:{init(){o(this)},slideChange(){o(this)}}})}))}function getDigits(e){return e.replace(/\D/g,"")}function validatePhoneNumber(e){const t=getDigits(e);return t.startsWith("7")||t.startsWith("8")?11===t.length:10===t.length}productDescCardReviewTexts&&productDescCardReviewTexts.forEach((e=>{const t=e.querySelector(".product-desc-card-review-text"),n=e.querySelector(".product-desc-card-review-more-btn"),r=n.querySelector(".btn-label"),o=e.closest(".product-desc-card-info"),s=e.closest(".product-desc-card");if(!s||!o)return;const i=new ResizeObserver((()=>{s.classList.contains("open")&&(o.style.maxHeight=o.scrollHeight+"px")}));t&&i.observe(t);const a=()=>{try{i.disconnect()}catch(e){}},c=s.parentNode;if(c){const e=new MutationObserver((t=>{for(const n of t)n.removedNodes.forEach((t=>{t===s&&(a(),e.disconnect())}))}));e.observe(c,{childList:!0})}n.addEventListener("click",(()=>{const e=!t.classList.contains("expanded");if(n.classList.toggle("open",e),r.textContent=e?"Скрыть":"Читать весь отзыв",e)t.classList.add("expanded"),t.style.maxHeight=t.scrollHeight+"px",setTimeout((()=>t.style.maxHeight="none"),0);else{const e=t.scrollHeight,n=3*parseFloat(getComputedStyle(t).lineHeight);t.style.maxHeight=e+"px",t.offsetHeight,t.style.maxHeight=n+"px",setTimeout((()=>t.classList.remove("expanded")),0)}}))})),initInteractiveCards(),initRelatedProductsSwiper();const phoneInput=document.getElementById("phone");function sendFile(){const e=document.getElementById("file-input");if(e){const t=["jpg","jpeg","png","webp"],n=document.getElementById("file-btn"),r=document.getElementById("file-info"),o=r.querySelector(".file-name"),s=document.getElementById("file-remove"),i=document.querySelector(".file-upload-wrapper");n.addEventListener("click",(()=>e.click())),e.addEventListener("change",(()=>{if(!e.files.length)return;const n=e.files[0],s=n.name.split(".").pop().toLowerCase();if(!t.includes(s))return alert("Неподдерживаемый формат: "+s),void(e.value="");const a=n.name.slice(0,5);o.textContent=`${a}.${s}`,i.classList.add("has-file"),r.style.display="flex"})),s.addEventListener("click",(()=>{e.value="",i.classList.remove("has-file"),r.style.display="none",o.textContent=""}))}}function clearReviewForm(){const e=document.querySelector(".send-review-form");if(!e)return;e.reset();const t=e.querySelectorAll(".send-review-stars svg");t.forEach((e=>e.classList.remove("filled"))),t.forEach((e=>e.classList.add("filled"))),currentRating=5,e.querySelectorAll(".error").forEach((e=>e.classList.remove("error")));const n=document.getElementById("file-info"),r=document.querySelector(".file-upload-wrapper"),o=r.querySelector(".file-name");n&&(n.style.display="none"),r&&r.classList.remove("has-file"),o&&(o.textContent="")}function ValidateReviewForm(){const e=document.querySelector(".send-review-form");if(!e)return;const t=e.querySelectorAll(".send-review-stars svg");let n=5;const r=e=>{t.forEach((t=>{t.classList.toggle("filled",parseInt(t.dataset.value,10)<=e)}))};r(n),t.forEach((e=>{const t=parseInt(e.dataset.value,10);e.addEventListener("mouseover",(()=>r(t))),e.addEventListener("mouseout",(()=>r(n))),e.addEventListener("click",(()=>{n=t,r(n)}))}));const o=e.querySelector('input[type="text"]'),s=e.querySelector('input[type="tel"]'),i=e.querySelector(".phone-error"),a=e.querySelector("textarea"),c=e.querySelector(".accept-politics"),l=c.querySelector('input[type="checkbox"]');let d=null;e.addEventListener("submit",(function(t){t.preventDefault();let r=!0;o.value.trim()?o.classList.remove("error"):(o.classList.add("error"),r=!1);const u=s.value.trim();if(u?validatePhoneNumber(u)?(s.classList.remove("error"),i.classList.remove("show")):(s.classList.add("error"),i.classList.add("show"),r=!1):(s.classList.remove("error"),i.classList.remove("show")),a.value.trim()?a.classList.remove("error"):(a.classList.add("error"),r=!1),l.checked?c.classList.remove("error"):(c.classList.add("error"),r=!1),!r)return;const m={name:o.value.trim(),phone:u||null,review:a.value.trim(),rating:n,accept:l.checked,file:document.getElementById("file-input").files[0]?.name||null},p=e.querySelector(".send-review-btn");if(!p)return console.warn("Кнопка отправки не найдена"),void sendFormReview(m);if(!p.querySelector(".btn-label.default")){const e=p.textContent.trim()||"Отправить";p.innerHTML=`<span class="btn-label default">${e}</span><span class="btn-label sent">Ваш отзыв отправлен</span>`}p.classList.contains("sent")?console.log("Кнопка уже в состоянии sent — игнорируем"):(console.log("Switch to sent state"),p.classList.add("sent"),p.disabled=!0,p.setAttribute("aria-disabled","true"),sendFormReview(m),d&&clearTimeout(d),d=setTimeout((()=>{console.log("Reverting button to normal state"),p.classList.remove("sent"),p.disabled=!1,p.removeAttribute("aria-disabled"),d=null}),5e3))})),o.addEventListener("input",(()=>{o.classList.contains("error")&&o.value.trim()&&o.classList.remove("error")})),s.addEventListener("input",(()=>{s.classList.contains("error")&&(!validatePhoneNumber(s.value)&&s.value.trim()||(s.classList.remove("error"),i.classList.remove("show")))})),a.addEventListener("input",(()=>{a.classList.contains("error")&&a.value.trim()&&a.classList.remove("error")})),l.addEventListener("change",(()=>{l.checked&&c.classList.remove("error")}))}phoneInput&&phoneInput.addEventListener("input",(e=>{let t=getDigits(phoneInput.value);if("deleteContentBackward"===e.inputType&&t.length<=1)return void(phoneInput.value="");let n="";t.startsWith("8")?(n="8 ",t=t.slice(1)):t.startsWith("7")&&(n="+7 ",t=t.slice(1)),t=t.slice(0,10);let r="";t.length>0&&(r+=`(${t.slice(0,3)}`),t.length>=4&&(r+=`) ${t.slice(3,6)}`),t.length>=7&&(r+=`-${t.slice(6,8)}`),t.length>=9&&(r+=`-${t.slice(8,10)}`);const o=phoneInput.selectionStart,s=phoneInput.value.length;phoneInput.value=n+r;const i=phoneInput.value.length;phoneInput.setSelectionRange(o+(i-s),o+(i-s))})),sendFile(),ValidateReviewForm();const addButtons=document.querySelectorAll(".js-add-btn"),qtySelectors=document.querySelectorAll(".js-qty-selector"),minusButtons=document.querySelectorAll(".js-minus"),plusButtons=document.querySelectorAll(".js-plus"),qtyValues=document.querySelectorAll(".js-qty-value");let isAdding=!1,currentCount=1;function showSelectors(){addButtons.forEach((e=>e.style.display="none")),qtySelectors.forEach((e=>{e.style.display="inline-flex",setTimeout((()=>e.classList.add("show")),10)}))}function hideSelectors(){qtySelectors.forEach((e=>e.classList.remove("show"))),setTimeout((()=>{qtySelectors.forEach((e=>e.style.display="none")),addButtons.forEach((e=>e.style.display="inline-block"))}),300)}function renderCount(){qtyValues.forEach((e=>e.textContent=currentCount))}function isOutOfStock(e){const t=e.closest(".js-item-buttons");if(!t)return!1;const n=t.querySelector(".js-add-btn");return!(!n||!n.classList.contains("order-btn-dissabled"))}function isElementVisible(e){if(!e)return!1;if(!e.getClientRects().length)return!1;const t=window.getComputedStyle(e);return"none"!==t.display&&"hidden"!==t.visibility&&0!==parseFloat(t.opacity)}let lastQtyChangeTime=0;const QTY_DEBOUNCE_MS=200;function removeFromCart(e){console.log(`Удаляем товар с ID = ${e}`)}function restoreToCart(e){console.log(`Восстанавливаем товар с ID = ${e}`)}function editCart(e,t){console.log(`CartId ${e}: count = ${t}`)}function fadeOut(e,t=400,n){e.style.transition=`opacity ${t}ms`,e.style.opacity=0,e.addEventListener("transitionend",(function t(r){"opacity"===r.propertyName&&(e.style.display="none",e.removeEventListener("transitionend",t),n&&n())}))}function fadeIn(e,t=400,n){e.style.display="",e.style.transition=`opacity ${t}ms`,e.style.opacity=0,requestAnimationFrame((()=>e.style.opacity=1)),e.addEventListener("transitionend",(function t(r){"opacity"===r.propertyName&&(e.removeEventListener("transitionend",t),n&&n())}))}function setupAddToCart(e){const t=e.querySelector(".add-to-cart-btn"),n=e.querySelector(".item-quantity-selector"),r=n.querySelector(".minus"),o=n.querySelector(".plus"),s=n.querySelector(".item-quantity-value");let i=parseInt(s.textContent,10)||1;t.addEventListener("click",(()=>{t.style.display="none",n.style.display="inline-flex",setTimeout((()=>n.classList.add("show")),10),addToCart(!0,i)})),r.addEventListener("click",(e=>{e.stopPropagation(),1===i?(n.classList.remove("show"),setTimeout((()=>{n.style.display="none",t.style.display="inline-block",addToCart(!1,0),i=1,s.textContent=i}),300)):(i--,s.textContent=i,addToCart(!0,i))})),o.addEventListener("click",(e=>{e.stopPropagation(),i++,s.textContent=i,addToCart(!0,i)}))}function setupCartQuantity(){document.querySelector(".cart")&&document.querySelectorAll(".quantity-selector").forEach((e=>{const t=e.querySelector(".minus"),n=e.querySelector(".plus"),r=e.querySelector(".quantity-value");let o=parseInt(r.textContent,10)||1;function s(e){o=e,r.textContent=o}t.addEventListener("click",(e=>{e.preventDefault(),o>1&&s(o-1)})),n.addEventListener("click",(e=>{e.preventDefault(),s(o+1)}))}))}addButtons.forEach((e=>{if(e.classList.contains("order-btn-dissabled")){try{e.disabled=!0}catch(e){}e.setAttribute("aria-disabled","true")}})),addButtons.forEach((e=>e.addEventListener("click",(function(e){e.preventDefault(),e.stopImmediatePropagation();isOutOfStock(e.currentTarget)||(showSelectors(),currentCount=1,renderCount(),addToCart(!0,currentCount))})))),minusButtons.forEach((e=>e.addEventListener("click",(t=>{if(t.preventDefault(),t.stopImmediatePropagation(),!isElementVisible(e))return;if(isOutOfStock(e))return;const n=Date.now();n-lastQtyChangeTime<200||(lastQtyChangeTime=n,currentCount<=1?(addToCart(!1,0),hideSelectors(),currentCount=1):(currentCount--,addToCart(!0,currentCount)),renderCount())})))),plusButtons.forEach((e=>e.addEventListener("click",(t=>{t.preventDefault(),t.stopImmediatePropagation();const n=qtySelectors[0].dataset.maxquantity;if(!isElementVisible(e))return;if(isOutOfStock(e))return;const r=Date.now();r-lastQtyChangeTime<200||(lastQtyChangeTime=r,0!=n&&currentCount==n||(currentCount++,renderCount(),addToCart(!0,currentCount)))})))),document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("remove-banner-template")?.content,t=document.querySelector(".cart-container"),n=document.getElementById("clear-cart-btn"),r=document.getElementById("select-all");e&&t&&n&&r&&(t.addEventListener("change",(e=>{(e.target.classList.contains("item-checkbox")||"select-all"===e.target.id)&&t.querySelectorAll(".custom-checkbox.error").forEach((e=>{e.classList.remove("error")}))})),n.addEventListener("click",(()=>{const n=Array.from(t.querySelectorAll(".cart-item")).filter((e=>!e.dataset.deleted)),o=n.map((e=>({item:e,checkbox:e.querySelector(".item-checkbox")}))).filter((({checkbox:e})=>e&&e.checked)),s=r.checked;if(!s&&0===o.length){n.forEach((e=>{const t=e.querySelector(".custom-checkbox");t&&t.classList.add("error")}));const e=document.querySelector(".cart-choice-all-button .custom-checkbox");return void(e&&e.classList.add("error"))}(s?n:o.map((({item:e})=>e))).forEach((t=>{if(t.dataset.deleted)return;t.dataset.deleted="true";removeFromCart(t.dataset.itemId);const n=t.querySelector(".cart-item-name").textContent.trim(),r=e.cloneNode(!0).querySelector(".cart-item-remove-banner");r.querySelector("span").textContent=`«${n}»`,fadeOut(t,400,(()=>{t.insertAdjacentElement("afterend",r),fadeIn(r,400)}))})),r.checked=!1})),t.addEventListener("click",(t=>{if(t.target.closest(".delete-cart-item-btn")){const n=t.target.closest(".cart-item");if(!n||n.dataset.deleted)return;n.dataset.deleted="true";removeFromCart(n.dataset.itemId);const r=n.querySelector(".cart-item-name").textContent.trim(),o=e.cloneNode(!0).querySelector(".cart-item-remove-banner");o.querySelector("span").textContent=`«${r}»`,fadeOut(n,400,(()=>{n.insertAdjacentElement("afterend",o),fadeIn(o,400)}))}if(t.target.closest(".recover-item-btn")){const e=t.target.closest(".cart-item-remove-banner"),n=e.previousElementSibling;if(!n)return;delete n.dataset.deleted;restoreToCart(n.dataset.itemId),fadeOut(e,400,(()=>{e.remove(),fadeIn(n,400)}))}if(t.target.closest(".hide-banner-item-btn")){const e=t.target.closest(".cart-item-remove-banner");fadeOut(e,400,(()=>e.remove()))}})),document.querySelectorAll(".cart-item").forEach((e=>{const t=e.getAttribute("data-item-id"),n=e.querySelector(".quantity-btn-cart-minus"),r=e.querySelector(".quantity-btn-cart-plus"),o=e.querySelector(".quantity-value");let s=parseInt(o.textContent,10)||1;n.addEventListener("click",(()=>{s>1&&(s--,o.textContent=s,editCart(t,s))})),r.addEventListener("click",(()=>{s++,o.textContent=s,editCart(t,s)}))})))})),document.querySelectorAll(".item-buttons").forEach((e=>{e.querySelector(".add-to-cart-btn")&&e.querySelector(".item-quantity-selector")&&setupAddToCart(e)})),setupCartQuantity();const promo=document.querySelector(".promo-code");let promoValid=!1;if(promo){const e=promo.querySelector("input"),t=promo.querySelector(".promo-code-btn"),n=promo.querySelector(".promo-code-clear"),r=document.querySelector(".promo-code-error");function updateButtonVisibility(){const r=e.value.trim().length>0;t.classList.toggle("visible",r),r||(n.classList.remove("visible"),hideError())}function showError(e){r.textContent=e,r.classList.add("visible"),r.style.maxHeight=`${r.scrollHeight}px`}function hideError(){r.classList.remove("visible"),r.style.maxHeight="0"}function checkPromoCode(e){return"ПРОМОКОД10"===e}e.addEventListener("input",updateButtonVisibility),t.addEventListener("click",(r=>{r.preventDefault();const o=e.value.trim();if(!o)return;t.classList.remove("visible"),n.classList.add("visible");const s=checkPromoCode(o);promoValid=s,s?(hideError(),console.log("Промокод принят:",o)):showError("Промокод не найден")})),n.addEventListener("click",(()=>{e.value="",n.classList.remove("visible"),t.classList.remove("visible"),hideError(),e.focus()}))}const btnSelectAll=document.querySelector(".cart-choice-all-button");if(btnSelectAll){const o=document.getElementById("select-all"),s=document.querySelectorAll(".item-checkbox");o.addEventListener("change",(()=>{s.forEach((e=>e.checked=o.checked))})),s.forEach((e=>{e.addEventListener("change",(()=>{const e=Array.from(s).every((e=>e.checked));o.checked=e}))}))}const deliveryMethodsText=document.querySelector(".delivery-methods-text");if(deliveryMethodsText){const i=document.querySelectorAll('input[name="delivery-method"]'),a={self:document.querySelector(".delivery-content-self"),delivery:document.querySelector(".delivery-content-delivery")},c=document.querySelector(".delivery-address");function updateDeliveryContent(){const e=document.querySelector('input[name="delivery-method"]:checked').value;if(Object.values(a).forEach((e=>e.classList.remove("active"))),a[e].classList.add("active"),"self"===e)c.style.maxHeight=`${c.scrollHeight}px`,requestAnimationFrame((()=>{c.style.maxHeight="0",c.classList.remove("visible")}));else{c.classList.add("visible");const e=c.scrollHeight;c.style.maxHeight="0",requestAnimationFrame((()=>{c.style.maxHeight=`${e}px`}))}}c.addEventListener("transitionend",(e=>{"max-height"===e.propertyName&&c.classList.contains("visible")&&(c.style.maxHeight="none")})),updateDeliveryContent(),i.forEach((e=>e.addEventListener("change",updateDeliveryContent)))}function sendOrderForm(e){console.log("Данные заказа:",e);const t=document.querySelector(".cart-form");t&&t.reset()}function validateOrderForm(){const e=document.querySelector(".cart-form");if(!e)return;const t=e.querySelectorAll(".cart-form-input"),n=t[0],r=t[1],o=t[2],s=t[3],i=t[4],a=t[5],c=e.querySelector(".phone-error"),l=e.querySelector(".accept-politics"),d=l.querySelector('input[type="checkbox"]'),u=document.querySelector(".promo-code input");r.addEventListener("input",(()=>{const e=r.value.trim();r.classList.contains("error")&&(validatePhoneNumber(e)||""===e)&&(r.classList.remove("error"),c.classList.remove("show"))})),e.addEventListener("submit",(function(m){m.preventDefault();let p=!0;t.forEach((e=>e.classList.remove("error"))),l.classList.remove("error"),c.classList.remove("show"),n.value.trim()||(n.classList.add("error"),p=!1);const y=r.value.trim();y?validatePhoneNumber(y)||(r.classList.add("error"),c.classList.add("show"),p=!1):(r.classList.add("error"),p=!1),o.value.trim()||(o.classList.add("error"),p=!1),d.checked||(l.classList.add("error"),p=!1);const h=e.querySelector('input[name="delivery-method"]:checked')?.value;if("delivery"===h&&(i.value.trim()||(i.classList.add("error"),p=!1)),!p)return;sendOrderForm({name:n.value.trim(),phone:y,email:o.value.trim(),person:e.querySelector('input[name="person-type"]:checked')?.value,deliveryMethod:h,city:"delivery"===h?s.value.trim():null,address:"delivery"===h?i.value.trim():null,comment:a.value.trim(),promo:promoValid?u.value.trim():null,accept:d.checked}),clearOrderForm()})),t.forEach((e=>{e.addEventListener("input",(()=>{e.classList.contains("error")&&e.value.trim()&&e.classList.remove("error")}))})),d.addEventListener("change",(()=>{d.checked&&l.classList.remove("error")}))}function clearOrderForm(){const e=document.querySelector(".cart-form");if(!e)return;e.reset(),e.querySelectorAll(".cart-form-input").forEach((e=>e.classList.remove("error")));const t=e.querySelector(".accept-politics");t&&t.classList.remove("error");const n=document.querySelector(".promo-code input");if(n){n.value="";const e=document.querySelector(".promo-code-clear"),t=document.querySelector(".promo-code-btn"),r=document.querySelector(".promo-code-error");e?.classList.remove("visible"),t?.classList.remove("visible"),r?.classList.remove("visible"),r.style.maxHeight="0"}}function smoothScrollTo(e,t=600){const n=window.pageYOffset,r=e.getBoundingClientRect().top+n-n;let o;requestAnimationFrame((function e(s){o||(o=s);const i=s-o,a=Math.min(i/t,1),c=a<.5?2*a*a:(4-2*a)*a-1;window.scrollTo(0,n+r*c),i<t&&requestAnimationFrame(e)}))}function openCardAndScroll(e){const t=document.querySelector(e),n=t&&t.closest(".product-desc-card");if(!n)return;document.querySelectorAll(".product-desc-card.open").forEach((e=>{if(e!==n){e.classList.remove("open");const t=e.querySelector(".product-desc-card-info");t&&(t.style.maxHeight=null)}}));const r=n.querySelector(".product-desc-card-info");if(n.classList.contains("open"))return void smoothScrollTo(n,800);n.classList.add("open"),r.style.maxHeight=r.scrollHeight+"px";const o=e=>{"max-height"===e.propertyName&&(smoothScrollTo(n,800),r.removeEventListener("transitionend",o))};r.addEventListener("transitionend",o)}validateOrderForm(),document.addEventListener("DOMContentLoaded",(()=>{"#reviews"===location.hash&&setTimeout((()=>openCardAndScroll("#reviews")),100),document.querySelectorAll('a[href="#reviews"]').forEach((e=>{e.addEventListener("click",(e=>{e.preventDefault(),history.pushState(null,"","#reviews"),openCardAndScroll("#reviews")}))})),window.addEventListener("hashchange",(()=>{"#reviews"===location.hash&&openCardAndScroll("#reviews")}))})),document.addEventListener("DOMContentLoaded",(()=>{const e=document.querySelector(".js-item-buttons"),t=document.querySelector(".js-related-products"),n=document.querySelector(".fixed-product-info"),r=document.querySelector("footer");if(!e||!n||!r)return;let o=!0,s=!1,i=!1,a=!t;const c=()=>{if(t&&a){const e=t.getBoundingClientRect().bottom+window.scrollY;if(window.scrollY>=e)return void n.classList.remove("visible")}o||s||i?n.classList.remove("visible"):n.classList.add("visible")},l=new IntersectionObserver((e=>{e.forEach((e=>{o=e.isIntersecting,c()}))}),{threshold:0});let d=null;t&&(d=new IntersectionObserver((e=>{e.forEach((e=>{e.isIntersecting&&(a=!0),s=e.isIntersecting,c()}))}),{root:null,rootMargin:`0px 0px -${n.offsetHeight}px 0px`,threshold:0}),d.observe(t));const u=new IntersectionObserver((e=>{e.forEach((e=>{i=e.isIntersecting,c()}))}),{root:null,rootMargin:`0px 0px -${n.offsetHeight}px 0px`,threshold:0});l.observe(e),u.observe(r),c(),window.addEventListener("scroll",c,{passive:!0}),window.addEventListener("resize",c)})),document.addEventListener("DOMContentLoaded",(()=>{const e=document.querySelector(".select-configuration-cards"),t=document.querySelector(".line-product");!e&&t&&(t.style.display="none")})),document.addEventListener("click",(function(e){e.target.closest(".order-btn-dissabled")&&(e.preventDefault(),e.stopPropagation())})),document.addEventListener("DOMContentLoaded",(function(){const e=document.querySelector(".header__catalog-nav-container");if(!e)return;const t=e.parentNode.firstElementChild;if(t&&t!==e){const e=t.getAttribute("style")||"";!/width\s*:\s*100%/i.test(e)&&!/height\s*:\s*\d+px/i.test(e)||t.classList.length||t.remove()}const n=document.querySelector(".design2024 .header"),r=document.querySelector(".design2024 .header__action"),o=window.matchMedia("(max-width: 639px)"),s=window.matchMedia("(max-width: 959px)"),i=window.matchMedia("(max-width: 1426px)");o.matches&&(e.classList.remove("is-fixed"),e.style.position="",e.style.left="",e.style.width="",n&&(n.classList.remove("is-transparent"),n.style.top="",n.classList.remove("small-hidden")));const a=260,c="transform 380ms cubic-bezier(0.2, 0.9, 0.2, 1), box-shadow 220ms ease",l=6,d=60,u=40,m=.45,p=220;let y=!1,h=0;if(e.style.transition=e.style.transition||c,n&&(n.style.transition=n.style.transition||"transform 420ms cubic-bezier(0.2, 0.9, 0.2, 1), opacity 320ms cubic-bezier(0.2, 0.9, 0.2, 1)"),r){const e=getComputedStyle(r),t="none"===e.display||"hidden"===e.visibility||r.classList.contains("is-fading-out");r.dataset._hidden=t?"1":"0"}function f(){const t=e.getBoundingClientRect();e.style.left=t.left+"px",e.style.width=t.width+"px"}function v(t){const n=e.parentNode;n&&(t?(n.dataset._origPaddingTop||(n.dataset._origPaddingTop=n.style.paddingTop||""),n.style.paddingTop="0px"):(n.style.paddingTop=n.dataset._origPaddingTop||"",delete n.dataset._origPaddingTop))}function g(){r&&"1"!==r.dataset._hidden&&(clearTimeout(r._hideTimeout),r.classList.add("is-fading-out"),r._hideTimeout=setTimeout((()=>{r.style.display="none",r.dataset._hidden="1",delete r._hideTimeout}),a))}function w(){if(!r)return;clearTimeout(r._hideTimeout);const e=getComputedStyle(r);"none"===e.display||"hidden"===e.visibility||r.classList.contains("is-fading-out")||"1"===r.dataset._hidden?(r.style.display="flex",r.offsetWidth,r.classList.remove("is-fading-out"),r.dataset._hidden="0",clearTimeout(r._hideTimeout),delete r._hideTimeout):r.dataset._hidden="0"}function L(e,t,n=!1){if(e)if(n){const n=e.style.transition;try{e.style.transition="none"}catch(e){}e.style.transform=`translate3d(0, ${t}px, 0)`,e.offsetHeight,setTimeout((()=>{try{e.style.transition=n||c}catch(e){}}),20)}else e.style.transform=`translate3d(0, ${t}px, 0)`}function b(e,t){L(e,t,!0)}function S(e){n&&requestAnimationFrame((()=>{const t=n.getBoundingClientRect(),r=t.bottom<=1||t.top<0;e?o.matches?r||n.classList.contains("small-hidden")?n.classList.add("is-transparent"):n.classList.remove("is-transparent"):n.classList.add("is-transparent"):n.classList.remove("is-transparent")}))}let E,q=window.pageYOffset,x=q,C=!1,A=!1,k=0,I=0,T=0,M=performance.now(),P=q;function H(){return performance.now()-k>p}function B(){e&&requestAnimationFrame((()=>{try{getComputedStyle(e).transform;if(C){const t=e.getBoundingClientRect(),r=n?n.getBoundingClientRect():null;if(t.height>0&&t.top>5&&t.top<window.innerHeight||n&&n.classList.contains("small-hidden")&&r&&r.top>5)return y=!1,O(!0,!1,0,!0),n&&(n.classList.remove("small-hidden"),n.style.transform="",S(!1)),w(),N(),void(k=performance.now())}else{try{e.style.removeProperty("transform")}catch(e){}if(e.style.left="",e.style.width="",v(!1),n){try{n.style.removeProperty("transform")}catch(e){}n.classList.remove("small-hidden"),S(!1)}}}catch(e){console.warn("ensureHeaderConsistency error",e)}}))}function O(t,r,s=null,i=!1){o.matches&&y&&null===s&&(s=h);const a=!!n?.classList.contains("is-transparent");if(!(t===C&&null===s)||r!==a)if(t){f(),C||(e.classList.add("is-fixed"),v(!0));const t=null!==s?s:o.matches?h:0;null!==s&&i?(b(e,t),n&&b(n,t),requestAnimationFrame(f),S(r)):requestAnimationFrame((()=>{L(e,t,!1),n&&(L(n,t,!1),S(r))})),C=!0}else{const t=e.style.transition;try{e.style.transition="none"}catch(e){}L(e,0,!0),e.offsetWidth,requestAnimationFrame((()=>{e.style.transition=t||c})),n&&S(!1),requestAnimationFrame((()=>{e.classList.remove("is-fixed"),e.style.left="",e.style.width="";try{e.style.removeProperty("transform")}catch(e){}if(n){try{n.style.removeProperty("transform")}catch(e){}n.classList.remove("small-hidden"),S(!1)}v(!1)})),C=!1}}function D(){return document.querySelector(".design2024 .headerSticky")||n||null}function F(){if(!s.matches)return;const e=D();e&&(e.classList.add("logo-hidden-on-scroll"),e.classList.remove("logo-visible-on-scroll"))}function N(){const e=D();e&&(e.classList.remove("logo-hidden-on-scroll"),e.classList.add("logo-visible-on-scroll"))}function U(){const e=q,t=e-x;if(o.matches){const r=performance.now(),o=Math.max(1,r-M),s=(e-P)/o;let i=0;i=Math.abs(t)<l?0:t>0?1:-1,i===T||0===T?I+=t:I=t,T=i,H()&&Math.abs(s)>m?s>0?(y=!0,O(!0,!0),n&&(L(n,h,!1),n.classList.add("small-hidden"),S(!0)),g(),F(),k=performance.now(),I=0):s<0&&(y=!1,O(!0,!1),n&&(n.classList.remove("small-hidden"),S(!1)),w(),N(),k=performance.now(),I=0):H()&&(I>d?(y=!0,O(!0,!0),n&&(L(n,h,!1),n.classList.add("small-hidden"),S(!0)),g(),F(),k=performance.now(),I=0):I<-u&&(y=!1,O(!0,!1),n&&(n.classList.remove("small-hidden"),S(!1)),w(),N(),k=performance.now(),I=0)),M=r,P=e}else t>l&&e>0?(O(!0,!0),g(),F()):t<-l&&(O(!1,!1),w(),N());x=e,A=!1}function R(){_();let e=window.pageYOffset,t=0;E=requestAnimationFrame((function n(){const r=window.pageYOffset;if(r!==e)q=r,requestAnimationFrame(U),e=r,t=0,E=requestAnimationFrame(n);else{if(t++,t>3)return B(),void _();E=requestAnimationFrame(n)}}))}function _(){E&&(cancelAnimationFrame(E),E=null)}e.style.willChange=e.style.willChange||"transform",window.addEventListener("scroll",(function(){q=window.pageYOffset,A||(A=!0,requestAnimationFrame(U))}),{passive:!0}),window.addEventListener("touchend",R,{passive:!0}),window.addEventListener("touchcancel",R,{passive:!0});let V=null,$=null;function j(e){if(null===V)return;const t=performance.now(),r=e.changedTouches&&e.changedTouches[0]?e.changedTouches[0].clientY:q,s=V-r,i=s/Math.max(1,t-$);n&&(n.style.transform=""),o.matches&&H()&&(s>10&&(s>d||i>m)?(y=!0,O(!0,!0,0,!0),n&&(L(n,h,!1),n.classList.add("small-hidden"),S(!0)),g(),F(),k=performance.now()):s<-10&&(Math.abs(s)>u||Math.abs(i)>.45)&&(y=!1,O(!0,!1,0,!0),n&&(L(n,0,!1),n.classList.remove("small-hidden"),S(!1)),w(),N(),k=performance.now())),V=null,$=null,I=0,T=0,requestAnimationFrame((()=>B())),setTimeout(B,120)}window.addEventListener("touchstart",(function(e){e.touches&&0!==e.touches.length&&(V=e.touches[0].clientY,$=performance.now(),I=0,T=0)}),{passive:!0}),window.addEventListener("touchmove",(function(e){if(!V||!e.touches||0===e.touches.length)return;const t=e.touches[0].clientY,r=V-t;if(o.matches&&n){const e=n.getBoundingClientRect().height||64,t=Math.max(-e,Math.min(0,.3*-r));n.style.transition=n.style.transition||"",n.style.transform=`translate3d(0, ${t}px, 0)`}}),{passive:!0}),window.addEventListener("touchend",j,{passive:!0}),window.addEventListener("touchcancel",j,{passive:!0}),window.addEventListener("wheel",(e=>{if(!o.matches)return;const t=e.deltaY;H()&&(t>60?(y=!0,O(!0,!0,0,!0),n&&(L(n,h,!0),n.classList.add("small-hidden"),S(!0)),g(),F(),k=performance.now()):t<-60&&(y=!1,O(!0,!1,0,!0),n&&(L(n,0,!0),n.classList.remove("small-hidden"),S(!1)),w(),N(),k=performance.now()))}),{passive:!0}),window.addEventListener("resize",(function(){if(C){f();const t=o.matches&&y||o.matches?h:0;L(e,t,!1),n&&L(n,t,!1)}else{try{e.style.removeProperty("transform")}catch(e){}if(e.style.left="",e.style.width="",n)try{n.style.removeProperty("transform")}catch(e){}}if(r){"none"!==getComputedStyle(r).display&&"1"===r.dataset._hidden&&(r.dataset._hidden="0")}}));const Y=()=>{if(C){f();const t=o.matches&&y||o.matches?h:0;L(e,t,!1),n&&L(n,t,!1)}else try{e.style.removeProperty("transform")}catch(e){}};i.addEventListener?i.addEventListener("change",Y):i.addListener&&i.addListener(Y),window.addEventListener("product:changed",(()=>{if(C)f(),L(e,o.matches?h:0,!1),n&&L(n,o.matches?h:0,!1);else{e.style.left="",e.style.width="";try{e.style.removeProperty("transform")}catch(e){}if(n)try{n.style.removeProperty("transform")}catch(e){}}r&&"1"===r.dataset._hidden&&(r.dataset._hidden="0",r.style.display="",r.classList.remove("is-fading-out")),n&&(n.classList.remove("small-hidden"),S(!1))})),q=window.pageYOffset,x=q,U(),function(){if(s.matches)q=window.pageYOffset,x=q,U();else{const e=D();e&&e.classList.remove("logo-hidden-on-scroll","logo-visible-on-scroll")}}()})),document.addEventListener("DOMContentLoaded",(function(){const e=document.querySelector(".header_catalog-nav-item"),t=document.querySelector(".header_catalog-nav-menu");if(e&&t){e.addEventListener("mouseenter",(function(){e.setAttribute("aria-expanded","false"),t.style.display="none"})),e.addEventListener("click",(function(){"true"===e.getAttribute("aria-expanded")?(e.setAttribute("aria-expanded","false"),t.style.display="none"):(e.setAttribute("aria-expanded","true"),t.style.display="block")}))}})),document.addEventListener("DOMContentLoaded",(function(){document.querySelectorAll(".image-container").forEach((e=>{const t=Array.from(e.querySelectorAll("img")),n=Array.from(e.querySelectorAll(".progress-bar .segment"));if(!t.length)return;t.forEach(((e,t)=>{e.style.opacity=0===t?"1":"0",e.style.transition=e.style.transition||"opacity 240ms ease",e.loading=0===t?"eager":"lazy"})),n.forEach(((e,t)=>e.classList.toggle("active",0===t)));let r=0;const o=t.length,s=s=>{s.classList.add("is-loaded"),r++,r>=o&&(e.classList.add("loaded"),t.forEach(((e,t)=>{e.style.opacity=0===t?"1":"0"})),n.forEach(((e,t)=>{e.classList.toggle("active",0===t)})))};t.forEach((e=>{e.complete&&e.naturalWidth?requestAnimationFrame((()=>setTimeout((()=>s(e)),20))):(e.addEventListener("load",(()=>s(e)),{once:!0}),e.addEventListener("error",(()=>s(e)),{once:!0}))}))}))})),document.addEventListener("DOMContentLoaded",(()=>{document.querySelectorAll(".uk-dropdown").forEach((e=>{window.UIkit&&UIkit.dropdown?UIkit.dropdown(e,{mode:"click"}):e.setAttribute("uk-dropdown","mode: click")}))}));const cardsContainer=document.querySelector(".select-configuration-cards");if(cardsContainer){const l=cardsContainer.querySelectorAll(".select-configuration-card"),d=cardsContainer.querySelector(".arrow-7"),u=()=>{const e=cardsContainer.scrollTop,t=cardsContainer.scrollHeight,n=e+cardsContainer.clientHeight>=t-10;n?(cardsContainer.style.webkitMaskImage="none",cardsContainer.style.maskImage="none"):(cardsContainer.style.webkitMaskImage="linear-gradient(to bottom, black 80%, transparent 100%)",cardsContainer.style.maskImage="linear-gradient(to bottom, black 80%, transparent 100%)"),d&&(n?(d.classList.add("hidden"),d.style.display="none"):(d.classList.remove("hidden"),d.style.display=""))};l.length>4?(u(),cardsContainer.addEventListener("scroll",u),window.addEventListener("resize",u)):(cardsContainer.style.webkitMaskImage="none",cardsContainer.style.maskImage="none",d&&(d.classList.add("hidden"),d.style.display="none"))}document.querySelectorAll(".quantity_inner .quantity").forEach((e=>{e&&(e.addEventListener("keydown",(t=>{"0"===t.key&&0===e.value.length&&t.preventDefault()})),e.addEventListener("input",(()=>{e.value=e.value.replace(/\D/g,""),""!==e.value&&"0"!==e.value||(e.value="1");const t=parseInt(e.dataset.maxCount)||99;parseInt(e.value)>t&&(e.value=t)})),e.addEventListener("blur",(()=>{""!==e.value&&"0"!==e.value||(e.value="1")})))}));function isPhone(t){return t.match(/^\+7 \d{3} \d{3}-\d{2}-\d{2}$/)?!0:!1}function isEmail(t){return/^[^\s@]+@[^\s@]+\.[^\s@]{2,8}$/.test(t)}function isInputValid(t){if("checkbox"===t.type||"radio"===t.type)return t.checked;if(!t.value)return!1;if("email"===t.type)return isEmail(t.value);if("tel"===t.type)return t.inputmask?.isComplete();return!0}function formAddError(t){t.closest(".form-group")?.classList.add("error")}function formRemoveError(t){t.closest(".form-group")?.classList.remove("error")}function toggleSubmitBtn(t){const e=t.querySelector("button[type=submit]"),s=t.querySelectorAll("input[required]"),i=[...s].some(t=>!isInputValid(t));e.disabled=i,e.style.opacity=i?.5:1,e.style.pointerEvents=i?"none":"auto"}const disabledForm=document.querySelectorAll(".disabled-form");if(disabledForm.length>0)disabledForm.forEach(t=>{const e=t.querySelectorAll("input[type=tel]");e&&e.forEach(e=>{Inputmask({mask:"+7 999 999-99-99",oncomplete:function(){formRemoveError(e)}}).mask(e)});const s=t.querySelectorAll("input[required]");if(s.length>0){let e;toggleSubmitBtn(t),s.forEach(s=>{["checkbox","radio"].includes(s.type)?s.addEventListener("change",()=>{formRemoveError(s),toggleSubmitBtn(t)}):"tel"!==s.type&&s.addEventListener("input",()=>{isInputValid(s)&&formRemoveError(s),clearTimeout(e),e=setTimeout(()=>{toggleSubmitBtn(t)},300)})}),t.addEventListener("submit",e=>{e.preventDefault();let i=0;s.forEach(s=>{isInputValid(s)||(i++,formAddError(s))}),0===i&&t.submit()})}});